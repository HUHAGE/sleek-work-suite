"use strict";const D=require("path"),st=require("fs"),ie=require("child_process"),Lt=require("util"),ae=require("events"),Pt=require("assert");function oe(t){const e=Object.create(null,{[Symbol.toStringTag]:{value:"Module"}});if(t){for(const r in t)if(r!=="default"){const n=Object.getOwnPropertyDescriptor(t,r);Object.defineProperty(e,r,n.get?n:{enumerable:!0,get:()=>t[r]})}}return e.default=t,Object.freeze(e)}const F=oe(st);function ce(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var wt={},z=D,B=process.platform==="win32",x=st,he=process.env.NODE_DEBUG&&/fs/.test(process.env.NODE_DEBUG);function le(){var t;if(he){var e=new Error;t=r}else t=n;return t;function r(s){s&&(e.message=s.message,s=e,n(s))}function n(s){if(s){if(process.throwDeprecation)throw s;if(!process.noDeprecation){var h="fs: missing callback "+(s.stack||s.message);process.traceDeprecation?console.trace(h):console.error(h)}}}}function ue(t){return typeof t=="function"?t:le()}z.normalize;if(B)var Q=/(.*?)(?:[\/\\]+|$)/g;else var Q=/(.*?)(?:[\/]+|$)/g;if(B)var bt=/^(?:[a-zA-Z]:|[\\\/]{2}[^\\\/]+[\\\/][^\\\/]+)?[\\\/]*/;else var bt=/^[\/]*/;wt.realpathSync=function(e,r){if(e=z.resolve(e),r&&Object.prototype.hasOwnProperty.call(r,e))return r[e];var n=e,s={},h={},f,g,d,w;S();function S(){var _=bt.exec(e);f=_[0].length,g=_[0],d=_[0],w="",B&&!h[d]&&(x.lstatSync(d),h[d]=!0)}for(;f<e.length;){Q.lastIndex=f;var O=Q.exec(e);if(w=g,g+=O[0],d=w+O[1],f=Q.lastIndex,!(h[d]||r&&r[d]===d)){var c;if(r&&Object.prototype.hasOwnProperty.call(r,d))c=r[d];else{var v=x.lstatSync(d);if(!v.isSymbolicLink()){h[d]=!0,r&&(r[d]=d);continue}var m=null;if(!B){var y=v.dev.toString(32)+":"+v.ino.toString(32);s.hasOwnProperty(y)&&(m=s[y])}m===null&&(x.statSync(d),m=x.readlinkSync(d)),c=z.resolve(w,m),r&&(r[d]=c),B||(s[y]=m)}e=z.resolve(c,e.slice(f)),S()}}return r&&(r[n]=e),e};wt.realpath=function(e,r,n){if(typeof n!="function"&&(n=ue(r),r=null),e=z.resolve(e),r&&Object.prototype.hasOwnProperty.call(r,e))return process.nextTick(n.bind(null,null,r[e]));var s=e,h={},f={},g,d,w,S;O();function O(){var _=bt.exec(e);g=_[0].length,d=_[0],w=_[0],S="",B&&!f[w]?x.lstat(w,function(A){if(A)return n(A);f[w]=!0,c()}):process.nextTick(c)}function c(){if(g>=e.length)return r&&(r[s]=e),n(null,e);Q.lastIndex=g;var _=Q.exec(e);return S=d,d+=_[0],w=S+_[1],g=Q.lastIndex,f[w]||r&&r[w]===w?process.nextTick(c):r&&Object.prototype.hasOwnProperty.call(r,w)?y(r[w]):x.lstat(w,v)}function v(_,A){if(_)return n(_);if(!A.isSymbolicLink())return f[w]=!0,r&&(r[w]=w),process.nextTick(c);if(!B){var b=A.dev.toString(32)+":"+A.ino.toString(32);if(h.hasOwnProperty(b))return m(null,h[b],w)}x.stat(w,function($){if($)return n($);x.readlink(w,function(i,a){B||(h[b]=a),m(i,a)})})}function m(_,A,b){if(_)return n(_);var $=z.resolve(S,A);r&&(r[b]=$),y($)}function y(_){e=z.resolve(_,e.slice(g)),O()}};var Mt=J;J.realpath=J;J.sync=_t;J.realpathSync=_t;J.monkeypatch=pe;J.unmonkeypatch=de;var H=st,pt=H.realpath,dt=H.realpathSync,fe=process.version,Tt=/^v[0-5]\./.test(fe),Nt=wt;function Ft(t){return t&&t.syscall==="realpath"&&(t.code==="ELOOP"||t.code==="ENOMEM"||t.code==="ENAMETOOLONG")}function J(t,e,r){if(Tt)return pt(t,e,r);typeof e=="function"&&(r=e,e=null),pt(t,e,function(n,s){Ft(n)?Nt.realpath(t,e,r):r(n,s)})}function _t(t,e){if(Tt)return dt(t,e);try{return dt(t,e)}catch(r){if(Ft(r))return Nt.realpathSync(t,e);throw r}}function pe(){H.realpath=J,H.realpathSync=_t}function de(){H.realpath=pt,H.realpathSync=dt}const ve=typeof process=="object"&&process&&process.platform==="win32";var ge=ve?{sep:"\\"}:{sep:"/"},me=Gt;function Gt(t,e,r){t instanceof RegExp&&(t=kt(t,r)),e instanceof RegExp&&(e=kt(e,r));var n=qt(t,e,r);return n&&{start:n[0],end:n[1],pre:r.slice(0,n[0]),body:r.slice(n[0]+t.length,n[1]),post:r.slice(n[1]+e.length)}}function kt(t,e){var r=e.match(t);return r?r[0]:null}Gt.range=qt;function qt(t,e,r){var n,s,h,f,g,d=r.indexOf(t),w=r.indexOf(e,d+1),S=d;if(d>=0&&w>0){if(t===e)return[d,w];for(n=[],h=r.length;S>=0&&!g;)S==d?(n.push(S),d=r.indexOf(t,S+1)):n.length==1?g=[n.pop(),w]:(s=n.pop(),s<h&&(h=s,f=w),w=r.indexOf(e,S+1)),S=d<w&&d>=0?d:w;n.length&&(g=[h,f])}return g}var xt=me,ye=_e,Bt="\0SLASH"+Math.random()+"\0",Jt="\0OPEN"+Math.random()+"\0",Et="\0CLOSE"+Math.random()+"\0",Ut="\0COMMA"+Math.random()+"\0",Wt="\0PERIOD"+Math.random()+"\0";function ot(t){return parseInt(t,10)==t?parseInt(t,10):t.charCodeAt(0)}function we(t){return t.split("\\\\").join(Bt).split("\\{").join(Jt).split("\\}").join(Et).split("\\,").join(Ut).split("\\.").join(Wt)}function be(t){return t.split(Bt).join("\\").split(Jt).join("{").split(Et).join("}").split(Ut).join(",").split(Wt).join(".")}function zt(t){if(!t)return[""];var e=[],r=xt("{","}",t);if(!r)return t.split(",");var n=r.pre,s=r.body,h=r.post,f=n.split(",");f[f.length-1]+="{"+s+"}";var g=zt(h);return h.length&&(f[f.length-1]+=g.shift(),f.push.apply(f,g)),e.push.apply(e,f),e}function _e(t){return t?(t.substr(0,2)==="{}"&&(t="\\{\\}"+t.substr(2)),K(we(t),!0).map(be)):[]}function Ee(t){return"{"+t+"}"}function Se(t){return/^-?0\d/.test(t)}function ke(t,e){return t<=e}function Oe(t,e){return t>=e}function K(t,e){var r=[],n=xt("{","}",t);if(!n)return[t];var s=n.pre,h=n.post.length?K(n.post,!1):[""];if(/\$$/.test(n.pre))for(var f=0;f<h.length;f++){var g=s+"{"+n.body+"}"+h[f];r.push(g)}else{var d=/^-?\d+\.\.-?\d+(?:\.\.-?\d+)?$/.test(n.body),w=/^[a-zA-Z]\.\.[a-zA-Z](?:\.\.-?\d+)?$/.test(n.body),S=d||w,O=n.body.indexOf(",")>=0;if(!S&&!O)return n.post.match(/,.*\}/)?(t=n.pre+"{"+n.body+Et+n.post,K(t)):[t];var c;if(S)c=n.body.split(/\.\./);else if(c=zt(n.body),c.length===1&&(c=K(c[0],!1).map(Ee),c.length===1))return h.map(function(k){return n.pre+c[0]+k});var v;if(S){var m=ot(c[0]),y=ot(c[1]),_=Math.max(c[0].length,c[1].length),A=c.length==3?Math.abs(ot(c[2])):1,b=ke,$=y<m;$&&(A*=-1,b=Oe);var i=c.some(Se);v=[];for(var a=m;b(a,y);a+=A){var u;if(w)u=String.fromCharCode(a),u==="\\"&&(u="");else if(u=String(a),i){var l=_-u.length;if(l>0){var o=new Array(l+1).join("0");a<0?u="-"+o+u.slice(1):u=o+u}}v.push(u)}}else{v=[];for(var p=0;p<c.length;p++)v.push.apply(v,K(c[p],!1))}for(var p=0;p<v.length;p++)for(var f=0;f<h.length;f++){var g=s+v[p]+h[f];(!e||S||g)&&r.push(g)}}return r}const L=it=(t,e,r={})=>(nt(e),!r.nocomment&&e.charAt(0)==="#"?!1:new at(e,r).match(t));var it=L;const vt=ge;L.sep=vt.sep;const N=Symbol("globstar **");L.GLOBSTAR=N;const Ae=ye,Ot={"!":{open:"(?:(?!(?:",close:"))[^/]*?)"},"?":{open:"(?:",close:")?"},"+":{open:"(?:",close:")+"},"*":{open:"(?:",close:")*"},"@":{open:"(?:",close:")"}},gt="[^/]",ct=gt+"*?",je="(?:(?!(?:\\/|^)(?:\\.{1,2})($|\\/)).)*?",$e="(?:(?!(?:\\/|^)\\.).)*?",Qt=t=>t.split("").reduce((e,r)=>(e[r]=!0,e),{}),At=Qt("().*{}+?[]^$\\!"),Ie=Qt("[.("),jt=/\/+/;L.filter=(t,e={})=>(r,n,s)=>L(r,t,e);const q=(t,e={})=>{const r={};return Object.keys(t).forEach(n=>r[n]=t[n]),Object.keys(e).forEach(n=>r[n]=e[n]),r};L.defaults=t=>{if(!t||typeof t!="object"||!Object.keys(t).length)return L;const e=L,r=(n,s,h)=>e(n,s,q(t,h));return r.Minimatch=class extends e.Minimatch{constructor(s,h){super(s,q(t,h))}},r.Minimatch.defaults=n=>e.defaults(q(t,n)).Minimatch,r.filter=(n,s)=>e.filter(n,q(t,s)),r.defaults=n=>e.defaults(q(t,n)),r.makeRe=(n,s)=>e.makeRe(n,q(t,s)),r.braceExpand=(n,s)=>e.braceExpand(n,q(t,s)),r.match=(n,s,h)=>e.match(n,s,q(t,h)),r};L.braceExpand=(t,e)=>Ht(t,e);const Ht=(t,e={})=>(nt(t),e.nobrace||!/\{(?:(?!\{).)*\}/.test(t)?[t]:Ae(t)),Re=1024*64,nt=t=>{if(typeof t!="string")throw new TypeError("invalid pattern");if(t.length>Re)throw new TypeError("pattern is too long")},ht=Symbol("subparse");L.makeRe=(t,e)=>new at(t,e||{}).makeRe();L.match=(t,e,r={})=>{const n=new at(e,r);return t=t.filter(s=>n.match(s)),n.options.nonull&&!t.length&&t.push(e),t};const Ce=t=>t.replace(/\\(.)/g,"$1"),De=t=>t.replace(/\\([^-\]])/g,"$1"),Le=t=>t.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&"),Pe=t=>t.replace(/[[\]\\]/g,"\\$&");let at=class{constructor(e,r){nt(e),r||(r={}),this.options=r,this.set=[],this.pattern=e,this.windowsPathsNoEscape=!!r.windowsPathsNoEscape||r.allowWindowsEscape===!1,this.windowsPathsNoEscape&&(this.pattern=this.pattern.replace(/\\/g,"/")),this.regexp=null,this.negate=!1,this.comment=!1,this.empty=!1,this.partial=!!r.partial,this.make()}debug(){}make(){const e=this.pattern,r=this.options;if(!r.nocomment&&e.charAt(0)==="#"){this.comment=!0;return}if(!e){this.empty=!0;return}this.parseNegate();let n=this.globSet=this.braceExpand();r.debug&&(this.debug=(...s)=>console.error(...s)),this.debug(this.pattern,n),n=this.globParts=n.map(s=>s.split(jt)),this.debug(this.pattern,n),n=n.map((s,h,f)=>s.map(this.parse,this)),this.debug(this.pattern,n),n=n.filter(s=>s.indexOf(!1)===-1),this.debug(this.pattern,n),this.set=n}parseNegate(){if(this.options.nonegate)return;const e=this.pattern;let r=!1,n=0;for(let s=0;s<e.length&&e.charAt(s)==="!";s++)r=!r,n++;n&&(this.pattern=e.slice(n)),this.negate=r}matchOne(e,r,n){var s=this.options;this.debug("matchOne",{this:this,file:e,pattern:r}),this.debug("matchOne",e.length,r.length);for(var h=0,f=0,g=e.length,d=r.length;h<g&&f<d;h++,f++){this.debug("matchOne loop");var w=r[f],S=e[h];if(this.debug(r,w,S),w===!1)return!1;if(w===N){this.debug("GLOBSTAR",[r,w,S]);var O=h,c=f+1;if(c===d){for(this.debug("** at the end");h<g;h++)if(e[h]==="."||e[h]===".."||!s.dot&&e[h].charAt(0)===".")return!1;return!0}for(;O<g;){var v=e[O];if(this.debug(`
globstar while`,e,O,r,c,v),this.matchOne(e.slice(O),r.slice(c),n))return this.debug("globstar found match!",O,g,v),!0;if(v==="."||v===".."||!s.dot&&v.charAt(0)==="."){this.debug("dot detected!",e,O,r,c);break}this.debug("globstar swallow a segment, and continue"),O++}return!!(n&&(this.debug(`
>>> no match, partial?`,e,O,r,c),O===g))}var m;if(typeof w=="string"?(m=S===w,this.debug("string match",w,S,m)):(m=S.match(w),this.debug("pattern match",w,S,m)),!m)return!1}if(h===g&&f===d)return!0;if(h===g)return n;if(f===d)return h===g-1&&e[h]==="";throw new Error("wtf?")}braceExpand(){return Ht(this.pattern,this.options)}parse(e,r){nt(e);const n=this.options;if(e==="**")if(n.noglobstar)e="*";else return N;if(e==="")return"";let s="",h=!1,f=!1;const g=[],d=[];let w,S=!1,O=-1,c=-1,v,m,y,_=e.charAt(0)===".",A=n.dot||_;const b=()=>_?"":A?"(?!(?:^|\\/)\\.{1,2}(?:$|\\/))":"(?!\\.)",$=l=>l.charAt(0)==="."?"":n.dot?"(?!(?:^|\\/)\\.{1,2}(?:$|\\/))":"(?!\\.)",i=()=>{if(w){switch(w){case"*":s+=ct,h=!0;break;case"?":s+=gt,h=!0;break;default:s+="\\"+w;break}this.debug("clearStateChar %j %j",w,s),w=!1}};for(let l=0,o;l<e.length&&(o=e.charAt(l));l++){if(this.debug("%s	%s %s %j",e,l,s,o),f){if(o==="/")return!1;At[o]&&(s+="\\"),s+=o,f=!1;continue}switch(o){case"/":return!1;case"\\":if(S&&e.charAt(l+1)==="-"){s+=o;continue}i(),f=!0;continue;case"?":case"*":case"+":case"@":case"!":if(this.debug("%s	%s %s %j <-- stateChar",e,l,s,o),S){this.debug("  in class"),o==="!"&&l===c+1&&(o="^"),s+=o;continue}this.debug("call clearStateChar %j",w),i(),w=o,n.noext&&i();continue;case"(":{if(S){s+="(";continue}if(!w){s+="\\(";continue}const p={type:w,start:l-1,reStart:s.length,open:Ot[w].open,close:Ot[w].close};this.debug(this.pattern,"	",p),g.push(p),s+=p.open,p.start===0&&p.type!=="!"&&(_=!0,s+=$(e.slice(l+1))),this.debug("plType %j %j",w,s),w=!1;continue}case")":{const p=g[g.length-1];if(S||!p){s+="\\)";continue}g.pop(),i(),h=!0,m=p,s+=m.close,m.type==="!"&&d.push(Object.assign(m,{reEnd:s.length}));continue}case"|":{const p=g[g.length-1];if(S||!p){s+="\\|";continue}i(),s+="|",p.start===0&&p.type!=="!"&&(_=!0,s+=$(e.slice(l+1)));continue}case"[":if(i(),S){s+="\\"+o;continue}S=!0,c=l,O=s.length,s+=o;continue;case"]":if(l===c+1||!S){s+="\\"+o;continue}v=e.substring(c+1,l);try{RegExp("["+Pe(De(v))+"]"),s+=o}catch{s=s.substring(0,O)+"(?:$.)"}h=!0,S=!1;continue;default:i(),At[o]&&!(o==="^"&&S)&&(s+="\\"),s+=o;break}}for(S&&(v=e.slice(c+1),y=this.parse(v,ht),s=s.substring(0,O)+"\\["+y[0],h=h||y[1]),m=g.pop();m;m=g.pop()){let l;l=s.slice(m.reStart+m.open.length),this.debug("setting tail",s,m),l=l.replace(/((?:\\{2}){0,64})(\\?)\|/g,(p,k,E)=>(E||(E="\\"),k+k+E+"|")),this.debug(`tail=%j
   %s`,l,l,m,s);const o=m.type==="*"?ct:m.type==="?"?gt:"\\"+m.type;h=!0,s=s.slice(0,m.reStart)+o+"\\("+l}i(),f&&(s+="\\\\");const a=Ie[s.charAt(0)];for(let l=d.length-1;l>-1;l--){const o=d[l],p=s.slice(0,o.reStart),k=s.slice(o.reStart,o.reEnd-8);let E=s.slice(o.reEnd);const j=s.slice(o.reEnd-8,o.reEnd)+E,C=p.split(")").length,P=p.split("(").length-C;let M=E;for(let I=0;I<P;I++)M=M.replace(/\)[+*?]?/,"");E=M;const T=E===""&&r!==ht?"(?:$|\\/)":"";s=p+k+E+T+j}if(s!==""&&h&&(s="(?=.)"+s),a&&(s=b()+s),r===ht)return[s,h];if(n.nocase&&!h&&(h=e.toUpperCase()!==e.toLowerCase()),!h)return Ce(e);const u=n.nocase?"i":"";try{return Object.assign(new RegExp("^"+s+"$",u),{_glob:e,_src:s})}catch{return new RegExp("$.")}}makeRe(){if(this.regexp||this.regexp===!1)return this.regexp;const e=this.set;if(!e.length)return this.regexp=!1,this.regexp;const r=this.options,n=r.noglobstar?ct:r.dot?je:$e,s=r.nocase?"i":"";let h=e.map(f=>(f=f.map(g=>typeof g=="string"?Le(g):g===N?N:g._src).reduce((g,d)=>(g[g.length-1]===N&&d===N||g.push(d),g),[]),f.forEach((g,d)=>{g!==N||f[d-1]===N||(d===0?f.length>1?f[d+1]="(?:\\/|"+n+"\\/)?"+f[d+1]:f[d]=n:d===f.length-1?f[d-1]+="(?:\\/|"+n+")?":(f[d-1]+="(?:\\/|\\/"+n+"\\/)"+f[d+1],f[d+1]=N))}),f.filter(g=>g!==N).join("/"))).join("|");h="^(?:"+h+")$",this.negate&&(h="^(?!"+h+").*$");try{this.regexp=new RegExp(h,s)}catch{this.regexp=!1}return this.regexp}match(e,r=this.partial){if(this.debug("match",e,this.pattern),this.comment)return!1;if(this.empty)return e==="";if(e==="/"&&r)return!0;const n=this.options;vt.sep!=="/"&&(e=e.split(vt.sep).join("/")),e=e.split(jt),this.debug(this.pattern,"split",e);const s=this.set;this.debug(this.pattern,"set",s);let h;for(let f=e.length-1;f>=0&&(h=e[f],!h);f--);for(let f=0;f<s.length;f++){const g=s[f];let d=e;if(n.matchBase&&g.length===1&&(d=[h]),this.matchOne(d,g,r))return n.flipNegate?!0:!this.negate}return n.flipNegate?!1:this.negate}static defaults(e){return L.defaults(e).Minimatch}};L.Minimatch=at;var mt={exports:{}},et={exports:{}},$t;function Me(){return $t||($t=1,typeof Object.create=="function"?et.exports=function(e,r){r&&(e.super_=r,e.prototype=Object.create(r.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}))}:et.exports=function(e,r){if(r){e.super_=r;var n=function(){};n.prototype=r.prototype,e.prototype=new n,e.prototype.constructor=e}}),et.exports}try{var It=require("util");if(typeof It.inherits!="function")throw"";mt.exports=It.inherits}catch{mt.exports=Me()}var Te=mt.exports,G={};G.setopts=Be;G.ownProp=Vt;G.makeAbs=Y;G.finish=Je;G.mark=Ue;G.isIgnored=Kt;G.childrenIgnored=We;function Vt(t,e){return Object.prototype.hasOwnProperty.call(t,e)}var Ne=st,W=D,Fe=it,Zt=D.isAbsolute,yt=Fe.Minimatch;function Ge(t,e){return t.localeCompare(e,"en")}function qe(t,e){t.ignore=e.ignore||[],Array.isArray(t.ignore)||(t.ignore=[t.ignore]),t.ignore.length&&(t.ignore=t.ignore.map(xe))}function xe(t){var e=null;if(t.slice(-3)==="/**"){var r=t.replace(/(\/\*\*)+$/,"");e=new yt(r,{dot:!0})}return{matcher:new yt(t,{dot:!0}),gmatcher:e}}function Be(t,e,r){if(r||(r={}),r.matchBase&&e.indexOf("/")===-1){if(r.noglobstar)throw new Error("base matching requires globstar");e="**/"+e}t.windowsPathsNoEscape=!!r.windowsPathsNoEscape||r.allowWindowsEscape===!1,t.windowsPathsNoEscape&&(e=e.replace(/\\/g,"/")),t.silent=!!r.silent,t.pattern=e,t.strict=r.strict!==!1,t.realpath=!!r.realpath,t.realpathCache=r.realpathCache||Object.create(null),t.follow=!!r.follow,t.dot=!!r.dot,t.mark=!!r.mark,t.nodir=!!r.nodir,t.nodir&&(t.mark=!0),t.sync=!!r.sync,t.nounique=!!r.nounique,t.nonull=!!r.nonull,t.nosort=!!r.nosort,t.nocase=!!r.nocase,t.stat=!!r.stat,t.noprocess=!!r.noprocess,t.absolute=!!r.absolute,t.fs=r.fs||Ne,t.maxLength=r.maxLength||1/0,t.cache=r.cache||Object.create(null),t.statCache=r.statCache||Object.create(null),t.symlinks=r.symlinks||Object.create(null),qe(t,r),t.changedCwd=!1;var n=process.cwd();Vt(r,"cwd")?(t.cwd=W.resolve(r.cwd),t.changedCwd=t.cwd!==n):t.cwd=W.resolve(n),t.root=r.root||W.resolve(t.cwd,"/"),t.root=W.resolve(t.root),t.cwdAbs=Zt(t.cwd)?t.cwd:Y(t,t.cwd),t.nomount=!!r.nomount,process.platform==="win32"&&(t.root=t.root.replace(/\\/g,"/"),t.cwd=t.cwd.replace(/\\/g,"/"),t.cwdAbs=t.cwdAbs.replace(/\\/g,"/")),r.nonegate=!0,r.nocomment=!0,t.minimatch=new yt(e,r),t.options=t.minimatch.options}function Je(t){for(var e=t.nounique,r=e?[]:Object.create(null),n=0,s=t.matches.length;n<s;n++){var h=t.matches[n];if(!h||Object.keys(h).length===0){if(t.nonull){var f=t.minimatch.globSet[n];e?r.push(f):r[f]=!0}}else{var g=Object.keys(h);e?r.push.apply(r,g):g.forEach(function(d){r[d]=!0})}}if(e||(r=Object.keys(r)),t.nosort||(r=r.sort(Ge)),t.mark){for(var n=0;n<r.length;n++)r[n]=t._mark(r[n]);t.nodir&&(r=r.filter(function(d){var w=!/\/$/.test(d),S=t.cache[d]||t.cache[Y(t,d)];return w&&S&&(w=S!=="DIR"&&!Array.isArray(S)),w}))}t.ignore.length&&(r=r.filter(function(d){return!Kt(t,d)})),t.found=r}function Ue(t,e){var r=Y(t,e),n=t.cache[r],s=e;if(n){var h=n==="DIR"||Array.isArray(n),f=e.slice(-1)==="/";if(h&&!f?s+="/":!h&&f&&(s=s.slice(0,-1)),s!==e){var g=Y(t,s);t.statCache[g]=t.statCache[r],t.cache[g]=t.cache[r]}}return s}function Y(t,e){var r=e;return e.charAt(0)==="/"?r=W.join(t.root,e):Zt(e)||e===""?r=e:t.changedCwd?r=W.resolve(t.cwd,e):r=W.resolve(e),process.platform==="win32"&&(r=r.replace(/\\/g,"/")),r}function Kt(t,e){return t.ignore.length?t.ignore.some(function(r){return r.matcher.match(e)||!!(r.gmatcher&&r.gmatcher.match(e))}):!1}function We(t,e){return t.ignore.length?t.ignore.some(function(r){return!!(r.gmatcher&&r.gmatcher.match(e))}):!1}var lt,Rt;function ze(){if(Rt)return lt;Rt=1,lt=S,S.GlobSync=O;var t=Mt,e=it;e.Minimatch,ne().Glob;var r=D,n=Pt,s=D.isAbsolute,h=G,f=h.setopts,g=h.ownProp,d=h.childrenIgnored,w=h.isIgnored;function S(c,v){if(typeof v=="function"||arguments.length===3)throw new TypeError(`callback provided to sync glob
See: https://github.com/isaacs/node-glob/issues/167`);return new O(c,v).found}function O(c,v){if(!c)throw new Error("must provide pattern");if(typeof v=="function"||arguments.length===3)throw new TypeError(`callback provided to sync glob
See: https://github.com/isaacs/node-glob/issues/167`);if(!(this instanceof O))return new O(c,v);if(f(this,c,v),this.noprocess)return this;var m=this.minimatch.set.length;this.matches=new Array(m);for(var y=0;y<m;y++)this._process(this.minimatch.set[y],y,!1);this._finish()}return O.prototype._finish=function(){if(n.ok(this instanceof O),this.realpath){var c=this;this.matches.forEach(function(v,m){var y=c.matches[m]=Object.create(null);for(var _ in v)try{_=c._makeAbs(_);var A=t.realpathSync(_,c.realpathCache);y[A]=!0}catch(b){if(b.syscall==="stat")y[c._makeAbs(_)]=!0;else throw b}})}h.finish(this)},O.prototype._process=function(c,v,m){n.ok(this instanceof O);for(var y=0;typeof c[y]=="string";)y++;var _;switch(y){case c.length:this._processSimple(c.join("/"),v);return;case 0:_=null;break;default:_=c.slice(0,y).join("/");break}var A=c.slice(y),b;_===null?b=".":((s(_)||s(c.map(function(a){return typeof a=="string"?a:"[*]"}).join("/")))&&(!_||!s(_))&&(_="/"+_),b=_);var $=this._makeAbs(b);if(!d(this,b)){var i=A[0]===e.GLOBSTAR;i?this._processGlobStar(_,b,$,A,v,m):this._processReaddir(_,b,$,A,v,m)}},O.prototype._processReaddir=function(c,v,m,y,_,A){var b=this._readdir(m,A);if(b){for(var $=y[0],i=!!this.minimatch.negate,a=$._glob,u=this.dot||a.charAt(0)===".",l=[],o=0;o<b.length;o++){var p=b[o];if(p.charAt(0)!=="."||u){var k;i&&!c?k=!p.match($):k=p.match($),k&&l.push(p)}}var E=l.length;if(E!==0){if(y.length===1&&!this.mark&&!this.stat){this.matches[_]||(this.matches[_]=Object.create(null));for(var o=0;o<E;o++){var p=l[o];c&&(c.slice(-1)!=="/"?p=c+"/"+p:p=c+p),p.charAt(0)==="/"&&!this.nomount&&(p=r.join(this.root,p)),this._emitMatch(_,p)}return}y.shift();for(var o=0;o<E;o++){var p=l[o],j;c?j=[c,p]:j=[p],this._process(j.concat(y),_,A)}}}},O.prototype._emitMatch=function(c,v){if(!w(this,v)){var m=this._makeAbs(v);if(this.mark&&(v=this._mark(v)),this.absolute&&(v=m),!this.matches[c][v]){if(this.nodir){var y=this.cache[m];if(y==="DIR"||Array.isArray(y))return}this.matches[c][v]=!0,this.stat&&this._stat(v)}}},O.prototype._readdirInGlobStar=function(c){if(this.follow)return this._readdir(c,!1);var v,m;try{m=this.fs.lstatSync(c)}catch(_){if(_.code==="ENOENT")return null}var y=m&&m.isSymbolicLink();return this.symlinks[c]=y,!y&&m&&!m.isDirectory()?this.cache[c]="FILE":v=this._readdir(c,!1),v},O.prototype._readdir=function(c,v){if(v&&!g(this.symlinks,c))return this._readdirInGlobStar(c);if(g(this.cache,c)){var m=this.cache[c];if(!m||m==="FILE")return null;if(Array.isArray(m))return m}try{return this._readdirEntries(c,this.fs.readdirSync(c))}catch(y){return this._readdirError(c,y),null}},O.prototype._readdirEntries=function(c,v){if(!this.mark&&!this.stat)for(var m=0;m<v.length;m++){var y=v[m];c==="/"?y=c+y:y=c+"/"+y,this.cache[y]=!0}return this.cache[c]=v,v},O.prototype._readdirError=function(c,v){switch(v.code){case"ENOTSUP":case"ENOTDIR":var m=this._makeAbs(c);if(this.cache[m]="FILE",m===this.cwdAbs){var y=new Error(v.code+" invalid cwd "+this.cwd);throw y.path=this.cwd,y.code=v.code,y}break;case"ENOENT":case"ELOOP":case"ENAMETOOLONG":case"UNKNOWN":this.cache[this._makeAbs(c)]=!1;break;default:if(this.cache[this._makeAbs(c)]=!1,this.strict)throw v;this.silent||console.error("glob error",v);break}},O.prototype._processGlobStar=function(c,v,m,y,_,A){var b=this._readdir(m,A);if(b){var $=y.slice(1),i=c?[c]:[],a=i.concat($);this._process(a,_,!1);var u=b.length,l=this.symlinks[m];if(!(l&&A))for(var o=0;o<u;o++){var p=b[o];if(!(p.charAt(0)==="."&&!this.dot)){var k=i.concat(b[o],$);this._process(k,_,!0);var E=i.concat(b[o],y);this._process(E,_,!0)}}}},O.prototype._processSimple=function(c,v){var m=this._stat(c);if(this.matches[v]||(this.matches[v]=Object.create(null)),!!m){if(c&&s(c)&&!this.nomount){var y=/[\/\\]$/.test(c);c.charAt(0)==="/"?c=r.join(this.root,c):(c=r.resolve(this.root,c),y&&(c+="/"))}process.platform==="win32"&&(c=c.replace(/\\/g,"/")),this._emitMatch(v,c)}},O.prototype._stat=function(c){var v=this._makeAbs(c),m=c.slice(-1)==="/";if(c.length>this.maxLength)return!1;if(!this.stat&&g(this.cache,v)){var A=this.cache[v];if(Array.isArray(A)&&(A="DIR"),!m||A==="DIR")return A;if(m&&A==="FILE")return!1}var y=this.statCache[v];if(!y){var _;try{_=this.fs.lstatSync(v)}catch(b){if(b&&(b.code==="ENOENT"||b.code==="ENOTDIR"))return this.statCache[v]=!1,!1}if(_&&_.isSymbolicLink())try{y=this.fs.statSync(v)}catch{y=_}else y=_}this.statCache[v]=y;var A=!0;return y&&(A=y.isDirectory()?"DIR":"FILE"),this.cache[v]=this.cache[v]||A,m&&A==="FILE"?!1:A},O.prototype._mark=function(c){return h.mark(this,c)},O.prototype._makeAbs=function(c){return h.makeAbs(this,c)},lt}var Xt=Yt;function Yt(t,e){if(t&&e)return Yt(t)(e);if(typeof t!="function")throw new TypeError("need wrapper function");return Object.keys(t).forEach(function(n){r[n]=t[n]}),r;function r(){for(var n=new Array(arguments.length),s=0;s<n.length;s++)n[s]=arguments[s];var h=t.apply(this,n),f=n[n.length-1];return typeof h=="function"&&h!==f&&Object.keys(f).forEach(function(g){h[g]=f[g]}),h}}var St={exports:{}},te=Xt;St.exports=te(rt);St.exports.strict=te(ee);rt.proto=rt(function(){Object.defineProperty(Function.prototype,"once",{value:function(){return rt(this)},configurable:!0}),Object.defineProperty(Function.prototype,"onceStrict",{value:function(){return ee(this)},configurable:!0})});function rt(t){var e=function(){return e.called?e.value:(e.called=!0,e.value=t.apply(this,arguments))};return e.called=!1,e}function ee(t){var e=function(){if(e.called)throw new Error(e.onceError);return e.called=!0,e.value=t.apply(this,arguments)},r=t.name||"Function wrapped with `once`";return e.onceError=r+" shouldn't be called more than once",e.called=!1,e}var re=St.exports,Qe=Xt,X=Object.create(null),He=re,Ve=Qe(Ze);function Ze(t,e){return X[t]?(X[t].push(e),null):(X[t]=[e],Ke(t))}function Ke(t){return He(function e(){var r=X[t],n=r.length,s=Xe(arguments);try{for(var h=0;h<n;h++)r[h].apply(null,s)}finally{r.length>n?(r.splice(0,n),process.nextTick(function(){e.apply(null,s)})):delete X[t]}})}function Xe(t){for(var e=t.length,r=[],n=0;n<e;n++)r[n]=t[n];return r}var ut,Ct;function ne(){if(Ct)return ut;Ct=1,ut=y;var t=Mt,e=it;e.Minimatch;var r=Te,n=ae.EventEmitter,s=D,h=Pt,f=D.isAbsolute,g=ze(),d=G,w=d.setopts,S=d.ownProp,O=Ve,c=d.childrenIgnored,v=d.isIgnored,m=re;function y(i,a,u){if(typeof a=="function"&&(u=a,a={}),a||(a={}),a.sync){if(u)throw new TypeError("callback provided to sync glob");return g(i,a)}return new b(i,a,u)}y.sync=g;var _=y.GlobSync=g.GlobSync;y.glob=y;function A(i,a){if(a===null||typeof a!="object")return i;for(var u=Object.keys(a),l=u.length;l--;)i[u[l]]=a[u[l]];return i}y.hasMagic=function(i,a){var u=A({},a);u.noprocess=!0;var l=new b(i,u),o=l.minimatch.set;if(!i)return!1;if(o.length>1)return!0;for(var p=0;p<o[0].length;p++)if(typeof o[0][p]!="string")return!0;return!1},y.Glob=b,r(b,n);function b(i,a,u){if(typeof a=="function"&&(u=a,a=null),a&&a.sync){if(u)throw new TypeError("callback provided to sync glob");return new _(i,a)}if(!(this instanceof b))return new b(i,a,u);w(this,i,a),this._didRealPath=!1;var l=this.minimatch.set.length;this.matches=new Array(l),typeof u=="function"&&(u=m(u),this.on("error",u),this.on("end",function(j){u(null,j)}));var o=this;if(this._processing=0,this._emitQueue=[],this._processQueue=[],this.paused=!1,this.noprocess)return this;if(l===0)return E();for(var p=!0,k=0;k<l;k++)this._process(this.minimatch.set[k],k,!1,E);p=!1;function E(){--o._processing,o._processing<=0&&(p?process.nextTick(function(){o._finish()}):o._finish())}}b.prototype._finish=function(){if(h(this instanceof b),!this.aborted){if(this.realpath&&!this._didRealpath)return this._realpath();d.finish(this),this.emit("end",this.found)}},b.prototype._realpath=function(){if(this._didRealpath)return;this._didRealpath=!0;var i=this.matches.length;if(i===0)return this._finish();for(var a=this,u=0;u<this.matches.length;u++)this._realpathSet(u,l);function l(){--i===0&&a._finish()}},b.prototype._realpathSet=function(i,a){var u=this.matches[i];if(!u)return a();var l=Object.keys(u),o=this,p=l.length;if(p===0)return a();var k=this.matches[i]=Object.create(null);l.forEach(function(E,j){E=o._makeAbs(E),t.realpath(E,o.realpathCache,function(C,P){C?C.syscall==="stat"?k[E]=!0:o.emit("error",C):k[P]=!0,--p===0&&(o.matches[i]=k,a())})})},b.prototype._mark=function(i){return d.mark(this,i)},b.prototype._makeAbs=function(i){return d.makeAbs(this,i)},b.prototype.abort=function(){this.aborted=!0,this.emit("abort")},b.prototype.pause=function(){this.paused||(this.paused=!0,this.emit("pause"))},b.prototype.resume=function(){if(this.paused){if(this.emit("resume"),this.paused=!1,this._emitQueue.length){var i=this._emitQueue.slice(0);this._emitQueue.length=0;for(var a=0;a<i.length;a++){var u=i[a];this._emitMatch(u[0],u[1])}}if(this._processQueue.length){var l=this._processQueue.slice(0);this._processQueue.length=0;for(var a=0;a<l.length;a++){var o=l[a];this._processing--,this._process(o[0],o[1],o[2],o[3])}}}},b.prototype._process=function(i,a,u,l){if(h(this instanceof b),h(typeof l=="function"),!this.aborted){if(this._processing++,this.paused){this._processQueue.push([i,a,u,l]);return}for(var o=0;typeof i[o]=="string";)o++;var p;switch(o){case i.length:this._processSimple(i.join("/"),a,l);return;case 0:p=null;break;default:p=i.slice(0,o).join("/");break}var k=i.slice(o),E;p===null?E=".":((f(p)||f(i.map(function(P){return typeof P=="string"?P:"[*]"}).join("/")))&&(!p||!f(p))&&(p="/"+p),E=p);var j=this._makeAbs(E);if(c(this,E))return l();var C=k[0]===e.GLOBSTAR;C?this._processGlobStar(p,E,j,k,a,u,l):this._processReaddir(p,E,j,k,a,u,l)}},b.prototype._processReaddir=function(i,a,u,l,o,p,k){var E=this;this._readdir(u,p,function(j,C){return E._processReaddir2(i,a,u,l,o,p,C,k)})},b.prototype._processReaddir2=function(i,a,u,l,o,p,k,E){if(!k)return E();for(var j=l[0],C=!!this.minimatch.negate,P=j._glob,M=this.dot||P.charAt(0)===".",T=[],I=0;I<k.length;I++){var R=k[I];if(R.charAt(0)!=="."||M){var V;C&&!i?V=!R.match(j):V=R.match(j),V&&T.push(R)}}var Z=T.length;if(Z===0)return E();if(l.length===1&&!this.mark&&!this.stat){this.matches[o]||(this.matches[o]=Object.create(null));for(var I=0;I<Z;I++){var R=T[I];i&&(i!=="/"?R=i+"/"+R:R=i+R),R.charAt(0)==="/"&&!this.nomount&&(R=s.join(this.root,R)),this._emitMatch(o,R)}return E()}l.shift();for(var I=0;I<Z;I++){var R=T[I];i&&(i!=="/"?R=i+"/"+R:R=i+R),this._process([R].concat(l),o,p,E)}E()},b.prototype._emitMatch=function(i,a){if(!this.aborted&&!v(this,a)){if(this.paused){this._emitQueue.push([i,a]);return}var u=f(a)?a:this._makeAbs(a);if(this.mark&&(a=this._mark(a)),this.absolute&&(a=u),!this.matches[i][a]){if(this.nodir){var l=this.cache[u];if(l==="DIR"||Array.isArray(l))return}this.matches[i][a]=!0;var o=this.statCache[u];o&&this.emit("stat",a,o),this.emit("match",a)}}},b.prototype._readdirInGlobStar=function(i,a){if(this.aborted)return;if(this.follow)return this._readdir(i,!1,a);var u="lstat\0"+i,l=this,o=O(u,p);o&&l.fs.lstat(i,o);function p(k,E){if(k&&k.code==="ENOENT")return a();var j=E&&E.isSymbolicLink();l.symlinks[i]=j,!j&&E&&!E.isDirectory()?(l.cache[i]="FILE",a()):l._readdir(i,!1,a)}},b.prototype._readdir=function(i,a,u){if(!this.aborted&&(u=O("readdir\0"+i+"\0"+a,u),!!u)){if(a&&!S(this.symlinks,i))return this._readdirInGlobStar(i,u);if(S(this.cache,i)){var l=this.cache[i];if(!l||l==="FILE")return u();if(Array.isArray(l))return u(null,l)}var o=this;o.fs.readdir(i,$(this,i,u))}};function $(i,a,u){return function(l,o){l?i._readdirError(a,l,u):i._readdirEntries(a,o,u)}}return b.prototype._readdirEntries=function(i,a,u){if(!this.aborted){if(!this.mark&&!this.stat)for(var l=0;l<a.length;l++){var o=a[l];i==="/"?o=i+o:o=i+"/"+o,this.cache[o]=!0}return this.cache[i]=a,u(null,a)}},b.prototype._readdirError=function(i,a,u){if(!this.aborted){switch(a.code){case"ENOTSUP":case"ENOTDIR":var l=this._makeAbs(i);if(this.cache[l]="FILE",l===this.cwdAbs){var o=new Error(a.code+" invalid cwd "+this.cwd);o.path=this.cwd,o.code=a.code,this.emit("error",o),this.abort()}break;case"ENOENT":case"ELOOP":case"ENAMETOOLONG":case"UNKNOWN":this.cache[this._makeAbs(i)]=!1;break;default:this.cache[this._makeAbs(i)]=!1,this.strict&&(this.emit("error",a),this.abort()),this.silent||console.error("glob error",a);break}return u()}},b.prototype._processGlobStar=function(i,a,u,l,o,p,k){var E=this;this._readdir(u,p,function(j,C){E._processGlobStar2(i,a,u,l,o,p,C,k)})},b.prototype._processGlobStar2=function(i,a,u,l,o,p,k,E){if(!k)return E();var j=l.slice(1),C=i?[i]:[],P=C.concat(j);this._process(P,o,!1,E);var M=this.symlinks[u],T=k.length;if(M&&p)return E();for(var I=0;I<T;I++){var R=k[I];if(!(R.charAt(0)==="."&&!this.dot)){var V=C.concat(k[I],j);this._process(V,o,!0,E);var Z=C.concat(k[I],l);this._process(Z,o,!0,E)}}E()},b.prototype._processSimple=function(i,a,u){var l=this;this._stat(i,function(o,p){l._processSimple2(i,a,o,p,u)})},b.prototype._processSimple2=function(i,a,u,l,o){if(this.matches[a]||(this.matches[a]=Object.create(null)),!l)return o();if(i&&f(i)&&!this.nomount){var p=/[\/\\]$/.test(i);i.charAt(0)==="/"?i=s.join(this.root,i):(i=s.resolve(this.root,i),p&&(i+="/"))}process.platform==="win32"&&(i=i.replace(/\\/g,"/")),this._emitMatch(a,i),o()},b.prototype._stat=function(i,a){var u=this._makeAbs(i),l=i.slice(-1)==="/";if(i.length>this.maxLength)return a();if(!this.stat&&S(this.cache,u)){var o=this.cache[u];if(Array.isArray(o)&&(o="DIR"),!l||o==="DIR")return a(null,o);if(l&&o==="FILE")return a()}var p=this.statCache[u];if(p!==void 0){if(p===!1)return a(null,p);var k=p.isDirectory()?"DIR":"FILE";return l&&k==="FILE"?a():a(null,k,p)}var E=this,j=O("stat\0"+u,C);j&&E.fs.lstat(u,j);function C(P,M){if(M&&M.isSymbolicLink())return E.fs.stat(u,function(T,I){T?E._stat2(i,u,null,M,a):E._stat2(i,u,T,I,a)});E._stat2(i,u,P,M,a)}},b.prototype._stat2=function(i,a,u,l,o){if(u&&(u.code==="ENOENT"||u.code==="ENOTDIR"))return this.statCache[a]=!1,o();var p=i.slice(-1)==="/";if(this.statCache[a]=l,a.slice(-1)==="/"&&l&&!l.isDirectory())return o(null,!1,l);var k=!0;return l&&(k=l.isDirectory()?"DIR":"FILE"),this.cache[a]=this.cache[a]||k,p&&k==="FILE"?o():o(null,k,l)},ut}var Ye=ne();const tr=ce(Ye),{app:tt,BrowserWindow:se,ipcMain:U,dialog:er,clipboard:rr,nativeTheme:nr}=require("electron"),ft=Lt.promisify(ie.exec),sr=Lt.promisify(tr);function ir(t){return new Promise((e,r)=>{const n=[];function s(h){const f=F.readdirSync(h);for(const g of f){const d=D.join(h,g);if(F.statSync(d).isDirectory())if(D.basename(d)==="target"){const S=F.readdirSync(d);for(const O of S)O.endsWith(".jar")&&n.push(D.join(d,O))}else s(d)}}try{s(t),e(n)}catch(h){r(h)}})}async function ar(t){try{if(console.log("开始扫描目录:",t),!F.existsSync(t))throw new Error("指定的目录不存在");const e="**/*.java";console.log("使用搜索模式:",e),console.log("在目录下搜索:",t);const r=await sr(e,{ignore:["**/target/**","**/build/**","**/bin/**","**/test/**"],cwd:t,dot:!0,nodir:!0});if(console.log("找到的Java文件:",r),console.log("找到的Java文件数量:",r.length),r.length===0)throw new Error("未找到任何Java文件，请检查目录是否正确");const n=[];for(const s of r)try{const h=D.join(t,s);console.log("正在处理文件:",h);const f=await F.promises.readFile(h,"utf-8"),g=/implements\s+(?:org\.quartz\.)?Job\b/,d=/extends\s+\w+\s+implements\s+(?:org\.quartz\.)?Job\b/;if(g.test(f)||d.test(f)){console.log("找到Job类:",h);const w=D.basename(h,".java"),S=f.includes("@DisallowConcurrentExecution");n.push({className:w,classPath:h,hasAnnotation:S})}}catch(h){console.error("读取文件失败:",s,h)}if(console.log("找到的Job类数量:",n.length),n.length===0)throw new Error("未找到任何Job类，请确认项目中是否包含实现了org.quartz.Job接口的类");return n}catch(e){throw console.error("Error scanning Job classes:",e),e}}async function or(t){try{let e=await F.promises.readFile(t,"utf-8");if(e.includes("@DisallowConcurrentExecution"))return;if(!e.includes("import org.quartz.DisallowConcurrentExecution;")){const r=`import org.quartz.DisallowConcurrentExecution;
`;e.includes("package ")?e=e.replace(/package [^;]+;/,`$&
${r}`):e=r+e}e=e.replace(/(public\s+class\s+[^{]+)/,`@DisallowConcurrentExecution
$1`),await F.promises.writeFile(t,e,"utf-8")}catch(e){throw console.error("Error adding annotation:",e),e}}function Dt(){const t=new se({width:1200,height:800,title:"HUHA工作提效小助手",webPreferences:{nodeIntegration:!1,contextIsolation:!0,preload:D.join(__dirname,"preload.js")},autoHideMenuBar:!0,frame:!0,backgroundColor:"#1a1a1a"});t.setBackgroundColor("#1a1a1a"),nr.themeSource="dark",t.setMenu(null),process.env.VITE_DEV_SERVER_URL?(t.loadURL(process.env.VITE_DEV_SERVER_URL),t.webContents.openDevTools()):t.loadFile(D.join(__dirname,"../dist/index.html")),U.handle("select-directory",async e=>(await er.showOpenDialog({properties:["openDirectory"]})).filePaths[0]),U.handle("scan-jar-files",async(e,r)=>{try{return(await ir(r)).map(s=>({name:D.basename(s),path:D.dirname(s)+D.sep,createTime:F.statSync(s).birthtime.getTime()}))}catch(n){throw console.error("Error scanning JAR files:",n),n}}),U.handle("copy-files",async(e,r)=>{try{const n=r.map(s=>D.join(s.path,s.name));if(process.platform==="win32"){const s=`
          Add-Type -AssemblyName System.Windows.Forms
          $paths = @(
            ${n.map(f=>`'${f.replace(/'/g,"''")}'`).join(`,
            `)}
          )
          $fileCollection = New-Object System.Collections.Specialized.StringCollection
          foreach ($path in $paths) {
            $fileCollection.Add($path)
          }
          [System.Windows.Forms.Clipboard]::SetFileDropList($fileCollection)
        `,h=D.join(tt.getPath("temp"),"copy-files.ps1");F.writeFileSync(h,s),await ft(`powershell -ExecutionPolicy Bypass -File "${h}"`),F.unlinkSync(h)}else rr.writeText(n.join(`
`));return!0}catch(n){throw console.error("Error copying files:",n),n}}),U.handle("set-window-title",async(e,r)=>(t.setTitle(r),!0)),U.handle("scan-job-classes",async(e,r)=>{try{return await ar(r)}catch(n){throw console.error("Error scanning Job classes:",n),n}}),U.handle("open-file",async(e,r)=>{try{process.platform==="win32"?await ft(`code "${r}"`):await ft(`open "${r}"`)}catch(n){throw console.error("Error opening file:",n),n}}),U.handle("add-annotation",async(e,r)=>{try{return await or(r),!0}catch(n){throw console.error("Error adding annotation:",n),n}})}tt.whenReady().then(()=>{Dt(),tt.on("activate",()=>{se.getAllWindows().length===0&&Dt()})});tt.on("window-all-closed",()=>{process.platform!=="darwin"&&tt.quit()});
